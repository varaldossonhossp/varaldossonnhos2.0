<!-- ============================================================
     💙 VARAL DOS SONHOS — Carrinho de Adoção (versão final inteligente)
     ------------------------------------------------------------
     Fluxo:
       1️⃣ Exibe a cartinha selecionada do localStorage
       2️⃣ Lista pontos de coleta do Airtable
       3️⃣ Abre modal com mapa do ponto selecionado
       4️⃣ Finaliza adoção via /api/adocoes
       5️⃣ Notifica o admin e limpa o carrinho
============================================================ -->

<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>💙 Carrinho de Adoção | Varal dos Sonhos</title>

  <!-- 🎨 Fontes e estilos -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <link rel="icon" href="../imagens/favicon.png" type="image/png" />
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="../css/carrinho.css" />
  <link rel="stylesheet" href="../css/cloudinho.css" />
</head>

<body class="bg-gradiente">
  <div id="header"></div>

  <main class="container container-carrinho">
    <h2 class="titulo-pagina">💙 Carrinho de Adoção</h2>
    <p>Revise suas informações antes de finalizar a adoção da cartinha.</p>

    <!-- Cartinha Selecionada -->
    <div class="cartinha-selecionada" id="cartinhaSelecionada">
      <img id="cartinha-img" src="../imagens/sem-foto.png" alt="Cartinha selecionada" />
      <div>
        <strong id="nome-crianca">Nome da Criança</strong>
        <p id="sonho-crianca">Sonho: —</p>
      </div>
    </div>

    <!-- Ponto de Coleta -->
    <div class="campo">
      <label for="select-ponto">📦 Ponto de Coleta:</label>
      <select id="select-ponto">
        <option>Selecione um ponto...</option>
      </select>
    </div>

    <!-- Botões -->
    <div style="text-align:center; margin-top:20px;">
      <button id="btn-ver-mapa" class="btn-secundario" style="background:#00a0ff; color:white;">📍 Ver Localização</button>
      <button id="btn-finalizar" class="btn-finalizar">✨ Finalizar Adoção</button>
      <button id="btn-limpar" class="btn-secundario" style="background:#ff5c5c; color:white;">🗑 Limpar Carrinho</button>
    </div>
  </main>

  <!-- Modal / iframe do Google Maps -->
  <div id="mapModal" class="map-modal" aria-hidden="true">
    <div class="map-backdrop" id="mapBackdrop"></div>
    <div class="map-frame">
      <button id="closeMap" class="map-close" aria-label="Fechar">✕</button>
      <iframe id="mapFrame" src="about:blank" frameborder="0" allowfullscreen></iframe>
      <div id="mapCaption" class="map-caption"></div>
    </div>
  </div>

  <div id="footer"></div>
  <div id="cloudinho"></div>

  <!-- Carrega componentes dinâmicos -->
  <script>
    async function carregarComponente(id, arquivo) {
      const base = location.pathname.includes("/pages/") ? "../componentes/" : "componentes/";
      const resp = await fetch(base + arquivo);
      if (resp.ok) document.getElementById(id).innerHTML = await resp.text();
    }
    carregarComponente("header", "header.html");
    carregarComponente("footer", "footer.html");
    carregarComponente("cloudinho", "cloudinho.html");
  </script>

  <!-- Scripts funcionais -->
  <script src="../js/carrinho.js"></script>
  <script src="../js/cloudinho.js"></script>
  <script src="../js/header.js"></script>
</body>
</html>
