<!-- // ============================================================
// üíô VARAL DOS SONHOS ‚Äî configuracao-site.html
// ------------------------------------------------------------
// 
// Configura√ß√£o geral do site para qualquer ONG usar
// Permite alterar:
// ‚úî Logo do Header
// ‚úî Imagem da Nuvem (cloud)
// ‚úî Link do Instagram
// ============================================================ -->

<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>‚öô Configura√ß√£o do Site</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #e3f2fd; font-family: Poppins, sans-serif; }
    .card { background:white; padding:25px; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,.1); }
    .btn-blue { background:#1e88e5; padding:10px 20px; color:white; border-radius:8px; }
  </style>
</head>

<body class="p-10">

  <h1 class="text-3xl font-bold text-blue-700 mb-6">‚öôÔ∏è Configura√ß√£o Geral do Site</h1>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <!-- LOGO -->
    <div class="card">
      <h2 class="text-xl font-bold text-blue-600 mb-2">üñº Logotipo</h2>
      <input type="file" id="logoUpload" class="mb-2">
      <button onclick="salvarLogo()" class="btn-blue">Salvar Logo</button>
      <div id="previewLogo" class="mt-3"></div>
    </div>

    <!-- NUVEM -->
    <div class="card">
      <h2 class="text-xl font-bold text-blue-600 mb-2">‚òÅÔ∏è Imagem da Nuvem</h2>
      <input type="file" id="nuvemUpload" class="mb-2">
      <button onclick="salvarNuvem()" class="btn-blue">Salvar Nuvem</button>
      <div id="previewNuvem" class="mt-3"></div>
    </div>

    <!-- Instagram -->
    <div class="card col-span-1 md:col-span-2">
      <h2 class="text-xl font-bold text-blue-600 mb-2">üì± Link do Instagram</h2>
      <input id="instagram" class="w-full border p-2 rounded mb-3" placeholder="https://instagram.com/suaong">
      <button onclick="salvarInstagram()" class="btn-blue">Salvar</button>
    </div>

  </div>

  <a href="admin.html" class="btn-blue mt-6 inline-block">‚¨Ö Voltar ao Painel Administrativo</a>

<script>
const TOKEN = "varaladmin";
const CLOUD_NAME = "drnn5zmxi";
const PRESET = "unsigned_uploads";

async function uploadImagem(file){
  const fd = new FormData();
  fd.append("file", file);
  fd.append("upload_preset", PRESET);

  const r = await fetch(
    `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`,
    { method:"POST", body:fd }
  );
  return (await r.json()).secure_url;
}

async function salvarLogo(){
  const file = logoUpload.files[0];
  if (!file) return alert("Selecione uma imagem");

  const url = await uploadImagem(file);

  await fetch("/api/admin", {
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "x-admin-token":TOKEN
    },
    body: JSON.stringify({
      acao:"salvar_config_site",
      logo_header:url
    })
  });

  alert("Logo atualizada!");
  previewLogo.innerHTML = `<img src="${url}" width="150">`;
}

async function salvarNuvem(){
  const file = nuvemUpload.files[0];
  if (!file) return alert("Selecione uma imagem");

  const url = await uploadImagem(file);

  await fetch("/api/admin", {
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "x-admin-token":TOKEN
    },
    body: JSON.stringify({
      acao:"salvar_config_site",
      nuvem_footer:url
    })
  });

  alert("Nuvem atualizada!");
  previewNuvem.innerHTML = `<img src="${url}" width="150">`;
}

async function salvarInstagram(){
  const link = instagram.value.trim();
  if (!link) return alert("Informe o link");

  await fetch("/api/admin", {
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "x-admin-token":TOKEN
    },
    body: JSON.stringify({
      acao:"salvar_config_site",
      instagram_url:link
    })
  });

  alert("Instagram atualizado!");
}
</script>

</body>
</html>
